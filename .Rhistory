library(readxl)
library(openxlsx)
library(rtracklayer)
library(ChIPseeker)
library(ChIPpeakAnno)
library(VennDiagram)
library(dplyr)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
library(clusterProfiler)
#JN
#need to annotate for the gene
setwd("D:/5_R_generated_Data/JN/3. 2022 ATAC")
jn_peaks<-import.bed("JN_NP_DEpeaks.bed")
jn_allpeaks_anno<- annotatePeak(jn_allpeaks, TxDb=txdb, tssRegion=c(-3000,3000), annoDb="org.Hs.eg.db")
jn_allpeaks_anno<- annotatePeak(jn_peaks, TxDb=txdb, tssRegion=c(-3000,3000), annoDb="org.Hs.eg.db")
jn_allpeaks_anno<- as.data.frame(jn_allpeaks_anno)
remove(jn_peaks)
rm(jn_allpeaks_anno
)
jn_allpeaks<-import.bed("JN_NP_allpeaks.bed")
jn_allpeaks_anno<- annotatePeak(jn_allpeaks, TxDb=txdb, tssRegion=c(-3000,3000), annoDb="org.Hs.eg.db")
jn_allpeaks_anno<- as.data.frame(jn_allpeaks_anno)
jn_allpeaks_anno <- jn_allpeaks_anno %>%  #rename columns!
rename("FC" = "V5")
View(jn_allpeaks_anno)
jn_allpeaks_anno <- jn_allpeaks_anno %>%  #rename columns!
rename("FC" = "score")
jn_allpeaks_anno_FC=jn_allpeaks_anno$FC
names(jn_allpeaks_anno_FC)<-as.character(jn_allpeaks_anno$SYMBOL)
jn_allpeaks_anno_FC <- sort(jn_allpeaks_anno_FC, decreasing = TRUE)
jn_allpeaks_gsea <- gseGO(geneList = jn_allpeaks_anno_FC,
ont = 'BP',
OrgDb = org.Hs.eg.db,
keyType = "ENTREZID",
#nPerm = 1000,
minGSSize = 20,
pvalueCutoff = 0.05,
verbose = FALSE)
names(jn_allpeaks_anno_FC)<-as.character(jn_allpeaks_anno$geneId)
jn_allpeaks_anno_FC <- sort(jn_allpeaks_anno_FC, decreasing = TRUE)
jn_allpeaks_gsea <- gseGO(geneList = jn_allpeaks_anno_FC,
ont = 'BP',
OrgDb = org.Hs.eg.db,
keyType = "ENTREZID",
#nPerm = 1000,
minGSSize = 20,
pvalueCutoff = 0.05,
verbose = FALSE)
dotplot(jn_allpeaks_gsea, showCategory=15) + ggtitle("JN all peaks")
library(tidyverse)
dotplot(jn_allpeaks_gsea, showCategory=15) + ggtitle("JN all peaks")
library('org.Hs.eg.db')
library(ggplot2)
jn_allpeaks_gsea <- gseGO(geneList = jn_allpeaks_anno_FC,
ont = 'BP',
OrgDb = org.Hs.eg.db,
keyType = "ENTREZID",
#nPerm = 1000,
minGSSize = 20,
pvalueCutoff = 0.05,
verbose = FALSE)
dotplot(jn_allpeaks_gsea, showCategory=15) + ggtitle("JN all peaks")
